From 29244be8f15bf03122fb9b3c38d680e67f014fae Mon Sep 17 00:00:00 2001
From: Ricardo Salveti <ricardo@foundries.io>
Date: Mon, 31 Aug 2020 19:39:14 -0300
Subject: [PATCH 046/322] [FIO extras] imx7ulpea: dts: enable DM QSPI flash

Signed-off-by: Jorge Ramirez-Ortiz <jorge@foundries.io>
Signed-off-by: Ricardo Salveti <ricardo@foundries.io>
---
 arch/arm/dts/imx7ulp-com.dts | 27 +++++++++++++++++++++++++++
 arch/arm/dts/imx7ulp.dtsi    |  1 -
 2 files changed, 27 insertions(+), 1 deletion(-)

diff --git a/arch/arm/dts/imx7ulp-com.dts b/arch/arm/dts/imx7ulp-com.dts
index c01e03dd061..f374f9ab1d2 100644
--- a/arch/arm/dts/imx7ulp-com.dts
+++ b/arch/arm/dts/imx7ulp-com.dts
@@ -49,6 +49,33 @@
 	status = "okay";
 };
 
+&qspi1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_qspi1_1>;
+	status = "okay";
+
+	flash0: mx25u3235f@0 {
+		reg = <0>;
+		#address-cells = <1>;
+		#size-cells = <1>;
+		compatible = "macronix,mx25u3235f";
+		spi-max-frequency = <29000000>;
+	};
+};
+
+&iomuxc {
+	pinctrl_qspi1_1: qspi1grp_1 {
+			fsl,pins = <
+			IMX7ULP_PAD_PTB8__QSPIA_SS0_B   0x43 /* SS0 */
+			IMX7ULP_PAD_PTB15__QSPIA_SCLK   0x43
+			IMX7ULP_PAD_PTB16__QSPIA_DATA3  0x43 /* D3 */
+			IMX7ULP_PAD_PTB17__QSPIA_DATA2  0x43 /* D2 */
+			IMX7ULP_PAD_PTB18__QSPIA_DATA1  0x43 /* D1 */
+			IMX7ULP_PAD_PTB19__QSPIA_DATA0  0x43 /* D0 */
+		>;
+	 };
+};
+
 &iomuxc1 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_hog_1>;
diff --git a/arch/arm/dts/imx7ulp.dtsi b/arch/arm/dts/imx7ulp.dtsi
index 642a1e0517a..ff62156f75d 100644
--- a/arch/arm/dts/imx7ulp.dtsi
+++ b/arch/arm/dts/imx7ulp.dtsi
@@ -535,7 +535,6 @@
 			compatible = "fsl,imx7ulp-iomuxc-0";
 			reg = <0x4103D000 0x1000>;
 			fsl,mux_mask = <0xf00>;
-			status = "disabled";
 		};
 
 		iomuxc1: iomuxc1@40ac0000 {
-- 
2.34.1

